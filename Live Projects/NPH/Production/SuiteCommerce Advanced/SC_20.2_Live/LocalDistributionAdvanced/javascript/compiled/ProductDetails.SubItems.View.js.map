{"version":3,"sources":["ProductDetails.SubItems.View.ts"],"names":[],"mappings":"AAAA,qDAAqD;AACrD,qFAAqF;;;IAerF,IAAM,UAAU,GAAQ,sBAAsB,CAAC,MAAM,CAAC;QAEpD,UAAU,EAAE,UAAU,OAAO;YAG5B,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,CAAC,SAAS,EAAE,CAAC;YAElD,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;YACnB,IAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAC,SAAS,CAAC,EAAC;gBACzC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,CAAC;aAC9C;YAED,sDAAsD;YAEtD,IAAI,CAAC,UAAU,GAAG,IAAI,cAAc,EAAE,CAAC;YACvC,IAAI,IAAI,GAAG,IAAI,CAAC;YAEhB,sBAAsB,CAAC,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,EAAE;gBACtD,UAAU,EAAE,IAAI,CAAC,UAAU;gBAC3B,SAAS,EAAE,4BAA4B;gBACvC,QAAQ,EAAE,6BAA6B;gBACvC,gBAAgB,EAAE;oBAChB,QAAQ,EAAC,IAAI;iBACb;aACF,CAAC,CAAC;YAEH,IAAG,IAAI,CAAC,QAAQ,CAAC,MAAM;gBACtB,IAAI,CAAC,eAAe,EAAE,CAAC;QACzB,CAAC;QAEA,eAAe,EAAE;YAGjB,IAAI,IAAI,GAAG,IAAI,CAAC;YAChB,IAAI,OAAO,GAAG,iCAAiC,GAAE,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;YAEzE,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC;iBAClB,IAAI,CAAC,UAAS,OAAO;gBAErB,IAAG,OAAO,IAAI,OAAO,CAAC,KAAK,GAAG,CAAC,EAC/B;oBACC,IAAI,KAAK,GAAG,CAAC,CAAC,GAAG,CAAC,OAAO,EAAC,OAAO,CAAC,CAAA,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,EAAC,+BAA+B,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;oBAEjG,IAAI,CAAC,UAAU,GAAG,IAAI,cAAc,CAAC,CAAC,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;oBACvD,IAAI,CAAC,MAAM,EAAE,CAAC;iBAEd;YAEF,CAAC,CAAC,CAAC;QACL,CAAC;KACF,CAAC,CAAC;IAEH,OAAS,UAAU,CAAC","file":"ProductDetails.SubItems.View.js","sourcesContent":["/// <amd-module name=\"ProductDetails.SubItems.View\"/>\n/// <reference path=\"../../../Commons/Utilities/JavaScript/UnderscoreExtended.d.ts\"/>\n\nimport * as _ from 'underscore';\nimport * as product_details_sub_items_tpl from 'product_details_sub_items.tpl';\nimport * as item_relations_cell_tpl from 'item_relations_cell.tpl';\nimport * as item_relations_row_tpl from 'item_relations_row.tpl';\n\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\n\nimport BackboneCollectionView = require('../../../Commons/Backbone.CollectionView/JavaScript/Backbone.CollectionView');\nimport ItemRelationsRelatedItemView = require('../../../Commons/ItemRelations/JavaScript/ItemRelations.RelatedItem.View');\nimport ItemCollection = require('../../../Commons/Item/JavaScript/Item.Collection');\n\n\nconst CustomView: any = BackboneCollectionView.extend({\n\n\t\tinitialize: function (options) {\n\t\t\n\t\t\t\n\t\t\tvar layout = this.options.application.getLayout();\n\t\t\t\n\t\t\tthis.subItems = [];\n\t\t\tif(_.has(this.options.subItems,'results')){\n\t\t\t\tthis.subItems = this.options.subItems.results;\n\t\t\t}\n\t\t\t\n\t\t\t//console.log('this.subItems', this.options.subItems);\n\n\t\t\tthis.collection = new ItemCollection();\n\t\t\tvar self = this;\n\t\t\t\n\t\t\tBackboneCollectionView.prototype.initialize.call(this, {\n\t\t\t\tcollection: self.collection,\n\t\t\t\tchildView: ItemRelationsRelatedItemView,\n\t\t\t\ttemplate: product_details_sub_items_tpl,\n\t\t\t\tchildViewOptions: {\n\t\t\t\t\t\tsubItems:true\n\t\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif(this.subItems.length)\n\t\t\t\tself.loadRelatedItem();\n\t\t}\n\t\t\n\t,\tloadRelatedItem: function()\n\t\t{\t\n\n\t\t\tvar self = this;\n\t\t\tvar itemUrl = '/api/items?fieldset=details&id='+ this.subItems.toString();\n\t\t\t\n\t\t\t jQuery.get(itemUrl)\n\t\t\t .then(function(results){\n\n\t\t\t \tif(results && results.total > 0)\n\t\t\t \t{ \n\t\t\t \t\tvar items = _.has(results,'items')? _.sortBy(results.items,'custitem_appf_item_group_sort') : [];\n\t\t\t\t\t\n\t\t\t \t\tself.collection = new ItemCollection(_.compact(items));\n\t\t\t \t\tself.render();\n\t\t\t\t\t\n\t\t\t \t}\n\t\t\t\t\n\t\t\t });\n\t\t}\n});\n\nexport = CustomView;"]}