{"version":3,"sources":["BswSubscription.View.ts"],"names":[],"mappings":"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","file":"BswSubscription.View.js","sourcesContent":["/// <amd-module name=\"BswSubscription.View\"/>\n/// <reference path=\"../../../Commons/Utilities/JavaScript/UnderscoreExtended.d.ts\"/>\n\nimport * as _ from 'underscore';\nimport * as bsw_subscription_tpl from 'bsw_subscription.tpl';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport { Configuration } from '../../../Advanced/SCA/JavaScript/Configuration';\n\nimport Backbone = require('../../../Commons/Utilities/JavaScript/backbone.custom');\nimport BackboneView = require('../../../Commons/BackboneExtras/JavaScript/Backbone.View');\nimport { GlobalViewsPaginationView } from '../../../Commons/GlobalViews/JavaScript/GlobalViews.Pagination.View';\nimport { UrlHelper } from '../../../Commons/UrlHelper/JavaScript/UrlHelper';\n\nconst CustomView: any = BackboneView.extend({\n\t\n\ttemplate: bsw_subscription_tpl\n\n,\ttitle: Utils.translate('Bible Study Workshop')\n\n,\tpage_header: Utils.translate('Bible Study Workshop')\n\n,\tattributes: {\n\t\t'id': 'bsw_subscription'\n\t,\t'class': 'SubscriptionsView'\n\t}\n\n,\tevents: {\n\t\t'click .bsw-subscription-filters [data-sort]': 'sortHandler'\n\t,\t'click [data-filter=\"title\"]': 'fiterHandler'\n\t}\n\t\n,\tgetSelectedMenu: function ()\n\t{\n\t\treturn 'my_subscriptions';\n\t}\n\t\n,\tgetBreadcrumbPages: function ()\n\t{\n\t\treturn {\n\t\t\t\ttext: this.title\n\t\t\t,\thref: '/bsw-subscription'\n\t\t};\n\t}\n\t//@method initialize\n,\tinitialize: function (options)\n\t{\n\t\tthis.application = options.application;\n\t\t\n\t}\n,\tbeforeShowContent: function()\n\t{\n\t\tvar url_options = Utils.parseUrlOptions(Backbone.history.fragment);\n\t\t\n\t\tthis.filters = {\n\t\t\tpage: this.getPageFromUrl(url_options.page),\n\t\t\tsort: _.has(url_options,'sort')? url_options.sort : '',\n\t\t\ttitle: _.has(url_options,'title')? url_options.title : '',\n\t\t\ttype: 'BSW',\n\t\t\tresults_per_page: 20\n\t\t}\n\t\t\n\t\t\n\t\treturn this.getResults(this.filters);\n\t}\n,\tsortHandler: function(e)\n\t{\n\t\tvar url = Backbone.history.fragment;\n\t\t\n\t\tvar data_sort = $(e.target).attr('data-sort');\n\t\t\n\t\turl = UrlHelper.setUrlParameter(url, 'sort', data_sort);\n\t\t\n\t\t\n\t\tBackbone.history.navigate(url, {trigger: true});\n\t}\n,\tfiterHandler: function(e)\n\t{\n\t\tvar filterInput = $('#filter-input').val();\n\t\tvar url = Backbone.history.fragment;\n\t\t\n\t\tif(filterInput)\n\t\t{\n\t\t\turl = UrlHelper.setUrlParameter(url, 'title',filterInput);\n\t\t\t\n\t\t\t\n\t\t}\n\t\telse{\n\t\t\turl = UrlHelper.removeUrlParameter(url, 'title');\n\t\t}\n\t\tBackbone.history.navigate(url, {trigger: true});\n\t\t\n\t}\n,\tgetPageFromUrl: function (url_value)\n\t{\n\t\tvar page_number = parseInt(url_value, 10);\n\n\t\treturn !isNaN(page_number) && page_number > 0 ? page_number : 1;\n\t}\n,\tgetResults: function(data)\n\t{\n\t\tvar self = this;\n\t\t\n\t\tvar promise = new Backbone.Model().save(\n\t\t\t\t\tdata\n\t\t\t\t,\t{\n\t\t\t\t\t\turl: Utils.getAbsoluteUrl('services/Subscriptions.Service.ss')\n\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\tpromise.then(function(result){\n\t\t\t\t\t\n\t\t\t\t\tself.collection = result;\n\t\t\t\t});\n\t\t\t\t\n\t\t\treturn promise;\n\t}\n\t//@property {Object} childViews\n,\tchildViews: {\n\t\t'GlobalViews.Pagination': function ()\n\t\t{\n\t\t\treturn new GlobalViewsPaginationView(_.extend({\n\t\t\t\ttotalPages: Math.ceil(this.collection.totalRecordsFound / this.collection.recordsPerPage)\n\t\t\t}, Configuration.defaultPaginationSettings));\n\t\t}\n\t}\n\n\t\n,\tgetContext: function ()\n\t{\t\n\t\t\n\t\treturn {\n\t\t\tfilterInput: this.filters.title\n\t\t,\trecords: _.has(this.collection,'records')? this.collection.records: []\n\t\t,\thaveSubscription: _.has(this.collection,'haveSubscription')? this.collection.haveSubscription: true\n\t\t\n\t\t};\n\t}\n});\nexport = CustomView;"]}