{"version":3,"sources":["Cart.Detailed.View.Ext.ts"],"names":[],"mappings":"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","file":"Cart.Detailed.View.Ext.js","sourcesContent":["/// <amd-module name=\"Cart.Detailed.View.Ext\"/>\nimport * as _ from 'underscore';\nimport * as Utils from '../../../Commons/Utilities/JavaScript/Utils';\nimport * as jQuery from '../../../Commons/Core/JavaScript/jQuery';\nimport existingView = require('../../../Commons/Cart/JavaScript/Cart.Detailed.View');\nimport { Configuration } from '../../../Commons/Utilities/JavaScript/Configuration';\n\nimport BackboneCollectionView = require('../../../Commons/Backbone.CollectionView/JavaScript/Backbone.CollectionView');\nimport CartLinesView = require('../../../Commons/Cart/JavaScript/Cart.Lines.View');\nimport CartItemSummaryView = require('../../../Commons/Cart/JavaScript/Cart.Item.Summary.View');\nimport CartItemActionsView = require('../../../Commons/Cart/JavaScript/Cart.Item.Actions.View');\nimport { GlobalViewsMessageView } from '../../../Commons/GlobalViews/JavaScript/GlobalViews.Message.View';\n\n_.extend(existingView.prototype, {\n\t\n\tchildViews: _.extend(existingView.prototype.childViews, {\n\t\t\n        'Item.ListNavigable': function() {\n            const lines = _.filter(this.model.get('lines').models || [], function(line: any) {\n                return (line.get('free_gift') !== true && line.get('item').get('custitem_appf_is_imprint_item') != true);\n            });\n\n            return new BackboneCollectionView({\n                collection: lines,\n                viewsPerRow: 1,\n                childView: CartLinesView,\n                childViewOptions: {\n                    navigable: true,\n                    application: this.application,\n                    SummaryView: CartItemSummaryView,\n                    ActionsView: CartItemActionsView,\n                    showAlert: false\n                }\n            });\n        }\n    }),\n\tinitPlugins: function initPlugins() {\n\t\tconst viewport_width = Utils.getViewportWidth();\n\t\tconst mobile_width_max = 768;\n\t\tif (Configuration.get('siteSettings.sitetype') === 'ADVANCED') {\n\n\t\t\tif(viewport_width < mobile_width_max){\n\n\t\t\t\tthis.$('.cart-detailed-proceed-to-checkout').scStickyButton();\n\t\t\t}\n\t\t\telse{   \n\t\t\t\tthis.$('[data-action=\"sticky\"]').scStickyButton();\n\t\t\t}\n\t\t}\n\t\tUtils.initBxSlider(\n\t\t\tthis.$('[data-type=\"carousel-items\"]'),\n\t\t\tConfiguration.get('bxSliderDefaults')\n\t\t);\n    },\n\t // @method updateItemQuantity\n    // Finds the item in the cart model, updates its quantity and saves the cart model\n    updateItemQuantity: function updateItemQuantity(e) {\n        const self = this;\n        const $form = this.getItemForm(e);\n        const options = (<any>$form).serializeObject();\n        let { internalid } = options;\n        let line = this.model.get('lines').get(internalid);\n        const $input = $form.find('[name=\"quantity\"]');\n        const validInput = this.validInputValue($input[0]);\n\n        if (!line || this.isRemoving) {\n            return;\n        }\n\n        if (!validInput || options.quantity) {\n            const new_quantity = parseInt(options.quantity, 10);\n            const item = line.get('item');\n            const min_quantity = item\n                ? item.get('_minimumQuantity', true)\n                : line.get('minimumquantity');\n            const max_quantity = item\n                ? item.get('_maximumQuantity', true)\n                : line.get('maximumquantity');\n            const current_quantity = parseInt(line.get('quantity'), 10);\n\n            let new_valid_quantity = new_quantity >= min_quantity ? new_quantity : min_quantity;\n            new_valid_quantity =\n                !!max_quantity && new_quantity > max_quantity\n                    ? max_quantity\n                    : new_quantity > min_quantity\n                    ? new_quantity\n                    : min_quantity;\n\n            $input.val(new_valid_quantity);\n\n            if (new_quantity !== current_quantity) {\n\t\t\t\t\n\t\t\t\t// calculation of quantity and evaluate internalid of imprint items\n\t\t\t\tvar addQty = 0\n\t\t\t\t,\tminusQty = 0\n\t\t\t\t,\timprintItem\n\t\t\t\t,\tisCrossItem\n\t\t\t\t,\tisHolyItem\n\t\t\t\t,\timprintItemId = 0\n\t\t\t\t,\tcrossItemId = 0\n\t\t\t\t,\tholyItemId = 0;\n\t\t\t\t\n\t\t\t\tif(new_quantity > current_quantity)\n\t\t\t\t\taddQty = new_quantity - current_quantity;\n\t\t\t\t\n\t\t\t\tif(new_quantity < current_quantity)\n\t\t\t\t\tminusQty = current_quantity - new_quantity;\n\t\t\t\t\n\t\t\t\tvar lineOptions = line.get('options') || '';\n\t\t\t\t\n\t\t\t\tif(_.has(lineOptions,'models'))\n\t\t\t\t _.each(lineOptions.models,function(opt:any){\n\t\t\t\t\t \n\t\t\t\t\t if(opt.get('cartOptionId') == \"custcol_appf_imprint_item_details\")\n\t\t\t\t\t\t imprintItem = !_.isUndefined(opt.get('value'))? opt.get('value').internalid : '';\n\t\t\t\t\t \n\t\t\t\t\tif(opt.get('cartOptionId') == \"custcol_appf_imprint_cross\")\n\t\t\t\t\t\tisCrossItem = !_.isUndefined(opt.get('value'))? opt.get('value').internalid : '';\n\t\t\t\t\n\t\t\t\t\tif(opt.get('cartOptionId') == \"custcol_appf_holy_bible\")\n\t\t\t\t\t\tisHolyItem = !_.isUndefined(opt.get('value'))? opt.get('value').internalid : '';\n\t\t\t\t\t \n\t\t\t\t\tif(imprintItem){\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(imprintItem.indexOf('|') != -1){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\timprintItemId = parseInt(imprintItem.split('|')[0]);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(isCrossItem == \"T\" && imprintItem.split('|').length > 1)\n\t\t\t\t\t\t\t\tcrossItemId = parseInt(imprintItem.split('|')[2]);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(isHolyItem == \"T\" && imprintItem.split('|').length > 3)\n\t\t\t\t\t\t\t\tholyItemId = parseInt(imprintItem.split('|')[4]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t });\n\t\t\t\t\n\t\t\t\t\n                $input.val(new_valid_quantity).prop('disabled', true);\n                line.set('quantity', new_valid_quantity);\n\n                const invalid = line.validate();\n\n                if (!invalid) {\n                    const update_promise = this.model.updateLine(line, true);\n                    this.disableElementsOnPromise(update_promise, `#${internalid} button`);\n\t\t\t\t\t\n\t\t\t\t\t//updating imprint items after update of main item\n\t\t\t\t\tupdate_promise.done(function (){\n\t\t\t\t\t\tif(imprintItemId){\n\t\t\t\t\t\t\tvar cartLines = self.model.get('lines');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t$(document).ajaxStart(function () {\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif($('#cart-loading').length == 0)\n\t\t\t\t\t\t\t\t\t$('body').append('<div id=\"cart-loading\"></div>');\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t$(document).ajaxStop(function () {\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif($('#cart-loading').length > 0)\n\t\t\t\t\t\t\t\t\t$('#cart-loading').remove();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(_.has(cartLines,'models')){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar promises = [];\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t_.each(cartLines.models,function(cartLine:any){\n\t\t\t\t\t\t\t\t\t//console.log(cartLine);\n\t\t\t\t\t\t\t\t\tif(cartLine.get('item').get('internalid') == imprintItemId){\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tvar imprintItemTotal = cartLine.get('quantity');\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif(addQty)\n\t\t\t\t\t\t\t\t\t\timprintItemTotal += addQty;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif(minusQty)\n\t\t\t\t\t\t\t\t\t\t\timprintItemTotal -= minusQty;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tcartLine.set('quantity', imprintItemTotal);\n\t\t\t\t\t\t\t\t\t\t//console.log(cartLine);\n\t\t\t\t\t\t\t\t\t\tvar promise = self.model.updateLine(cartLine, true);\n\t\t\t\t\t\t\t\t\t\tpromises.push(promise);\n\t\t\t\t\t\t\t\t\t\t//imprintItemLineId =  cartLine.internalid;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(crossItemId && cartLine.get('item').get('internalid') == crossItemId){\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tvar crossItemTotal = cartLine.get('quantity');\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif(addQty)\n\t\t\t\t\t\t\t\t\t\tcrossItemTotal += addQty;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif(minusQty)\n\t\t\t\t\t\t\t\t\t\t\tcrossItemTotal -= minusQty;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tcartLine.set('quantity', crossItemTotal);\n\t\t\t\t\t\t\t\t\t\t//console.log(cartLine);\n\t\t\t\t\t\t\t\t\t\tvar promise = self.model.updateLine(cartLine, true);\n\t\t\t\t\t\t\t\t\t\tpromises.push(promise);\n\t\t\t\t\t\t\t\t\t\t//crossItemTotal = cartLine.quantity;\n\t\t\t\t\t\t\t\t\t\t//crossItemLineId =  cartLine.internalid;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(holyItemId && cartLine.get('item').get('internalid') == holyItemId){\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tvar holyItemTotal = cartLine.get('quantity');\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif(addQty)\n\t\t\t\t\t\t\t\t\t\tholyItemTotal += addQty;\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tif(minusQty)\n\t\t\t\t\t\t\t\t\t\t\tholyItemTotal -= minusQty;\n\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tcartLine.set('quantity', holyItemTotal);\n\t\t\t\t\t\t\t\t\t\t//console.log(cartLine);\n\t\t\t\t\t\t\t\t\t\tvar promise = self.model.updateLine(cartLine, true);\n\t\t\t\t\t\t\t\t\t\tpromises.push(promise);\n\t\t\t\t\t\t\t\t\t\t//holyItemTotal = cartLine.quantity;\n\t\t\t\t\t\t\t\t\t\t//holyItemLineId = cartLine.internalid;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tif(promises.length > 0){\n\t\t\t\t\t\t\t\t\tjQuery.when(promises).then(function(valArray) {\n\t\t\t\t\t\t\t\t\t\tself.model.fetch();\n\t\t\t\t\t\t\t\t\t\t//self.render();\n\t\t\t\t\t\t\t\t\t\tconsole.log(valArray);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\t\n                    update_promise\n                        .fail(function(jqXhr) {\n                            const result = JSON.parse(jqXhr.responseText);\n                            const { errorDetails } = result;\n\n                            if (errorDetails.newLineId) {\n                                internalid = errorDetails.newLineId;\n                                // we use the new line\n                                line = self.model.get('lines').get(internalid);\n                            }\n\n                            // revert quantity to the last quantity\n                            line.set('quantity', current_quantity);\n                            self.render();\n                        })\n                        .always(function() {\n                            $input.prop('disabled', false);\n                        });\n                } else {\n                    const placeholder = this.$(`#${internalid} [data-type=\"alert-placeholder\"]`);\n                    placeholder.empty();\n\n                    _.each(invalid, function(value) {\n                        const global_view_message = new GlobalViewsMessageView({\n                            message: value,\n                            type: 'error',\n                            closable: true\n                        });\n\n                        placeholder.append(global_view_message.render().$el.html());\n                    });\n\n                    $input.prop('disabled', false);\n                    line.set('quantity', current_quantity);\n                }\n            }\n        }\n    },\n\t// @method removeItem\n    // handles the click event of the remove button\n    // removes the item from the cart model and saves it.\n    removeItem: function removeItem(e) {\n        const self = this;\n        const product = this.model.get('lines').get(this.$(e.target).data('internalid'));\n        const remove_promise = this.model.removeLine(product);\n        const internalid = product.get('internalid');\n\t\t\n\t\t\n\t\tvar imprintItem\n\t\t,\tisCrossItem\n\t\t,\tisHolyItem\n\t\t,\timprintItemId = 0\n\t\t,\tcrossItemId = 0\n\t\t,\tholyItemId = 0;\n\t\t\n\t\tvar options = product.get('options') || '';\n\t\tvar itemQty = product.get('quantity') || '';\n\t\t\n\t\tif(_.has(options,'models')){\n\t\t\t _.each(options.models,function(opt:any){\n\t\t\t\t \n\t\t\t\t if(opt.get('cartOptionId') == \"custcol_appf_imprint_item_details\")\n\t\t\t\t\t imprintItem = !_.isUndefined(opt.get('value'))? opt.get('value').internalid : '';\n\t\t\t\t \n\t\t\t\tif(opt.get('cartOptionId') == \"custcol_appf_imprint_cross\")\n\t\t\t\t\tisCrossItem = !_.isUndefined(opt.get('value'))? opt.get('value').internalid : '';\n\t\t\t\n\t\t\t\tif(opt.get('cartOptionId') == \"custcol_appf_holy_bible\")\n\t\t\t\t\tisHolyItem = !_.isUndefined(opt.get('value'))? opt.get('value').internalid : '';\n\t\t\t\t \n\t\t\t\tif(imprintItem){\n\t\t\t\t\t\n\t\t\t\t\tif(imprintItem.indexOf('|') != -1){\n\t\t\t\t\t\t\n\t\t\t\t\t\timprintItemId = parseInt(imprintItem.split('|')[0]);\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(isCrossItem == \"T\")\n\t\t\t\t\t\t\tcrossItemId = parseInt(imprintItem.split('|')[2]);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(isHolyItem == \"T\")\n\t\t\t\t\t\t\tholyItemId = parseInt(imprintItem.split('|')[4]);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t });\n\t\t}\n\t\t//console.log(itemQty + ' - ' + imprintItemId  + ' - ' + crossItemId  + ' - ' + holyItemId);\n\t\t\n\t\tremove_promise.done(function(){\n\t\t\tif(imprintItemId){\n\t\t\t\tvar cartLines = self.model.get('lines');\n\t\t\t\t\n\t\t\t\t$(document).ajaxStart(function () {\n\t\t\t\t\t\n\t\t\t\t\tif($('#cart-loading').length == 0)\n\t\t\t\t\t\t$('body').append('<div id=\"cart-loading\"></div>');\n\t\t\t\t});\n\t\t\t\t$(document).ajaxStop(function () {\n\t\t\t\t\t\n\t\t\t\t\tif($('#cart-loading').length > 0)\n\t\t\t\t\t\t$('#cart-loading').remove();\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tvar promises = [];\n\t\t\t\tif(_.has(cartLines,'models')){\n\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t_.each(cartLines.models,function(cartLine:any){\n\t\t\t\t\t\t//console.log(cartLine);\n\t\t\t\t\t\tif(cartLine.get('item').get('internalid') == imprintItemId){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar imprintItemTotal = cartLine.get('quantity');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(imprintItemTotal == itemQty){\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar promise = self.model.removeLine(cartLine);\n\t\t\t\t\t\t\t\tpromises.push(promise);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\timprintItemTotal -= itemQty;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcartLine.set('quantity', imprintItemTotal);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar promise = self.model.updateLine(cartLine, true);\n\t\t\t\t\t\t\tpromises.push(promise);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(crossItemId && cartLine.get('item').get('internalid') == crossItemId){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar crossItemTotal = cartLine.get('quantity');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(crossItemTotal == itemQty){\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar promise = self.model.removeLine(cartLine);\n\t\t\t\t\t\t\t\tpromises.push(promise);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tcrossItemTotal -= itemQty;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcartLine.set('quantity', crossItemTotal);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar promise = self.model.updateLine(cartLine, true);\n\t\t\t\t\t\t\tpromises.push(promise);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(holyItemId && cartLine.get('item').get('internalid') == holyItemId){\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar holyItemTotal = cartLine.get('quantity');\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(holyItemTotal == itemQty){\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tvar promise = self.model.removeLine(cartLine);\n\t\t\t\t\t\t\t\tpromises.push(promise);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tholyItemTotal -= itemQty;\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tcartLine.set('quantity', holyItemTotal);\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar promise = self.model.updateLine(cartLine, true);\n\t\t\t\t\t\t\tpromises.push(promise);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif(promises.length > 0){\n\t\t\t\t\tjQuery.when(promises).then(function(valArray) {\n\t\t\t\t\t\tself.model.fetch();\n\t\t\t\t\t\t//self.render();\n\t\t\t\t\t\tconsole.log(valArray);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n        this.isRemoving = true;\n        this.disableElementsOnPromise(\n            remove_promise,\n            `article[id=\"${internalid}\"] a, article[id=\"${internalid}\"] button`\n        );\n\n        remove_promise.always(function() {\n            self.isRemoving = false;\n        });\n\n        return remove_promise;\n    },\n\t// @method getContext @return {Cart.Detailed.View.Context}\n    getContext: function() {\n        const lines = this.model.get('lines');\n        var product_count = lines.length;\n        var item_count = _.reduce(\n            lines.models,\n            function(memo, line: any) {\n                return memo + line.get('quantity');\n            },\n            0\n        );\n        let product_and_items_count = '';\n\t\t\n\t\t_.each(lines.models,function(line:any){\n\t\t\t\n\t\t\t if(line.get('item').get('custitem_appf_is_imprint_item') == true)\n\t\t\t {\n\t\t\t\t\t\n\t\t\t\t item_count = item_count - line.get('quantity');\n\t\t\t\tproduct_count--;\n\t\t\t }\n\t\t});\n\n        if (product_count === 1) {\n            if (item_count === 1) {\n                product_and_items_count = Utils.translate('1 Product, 1 Item');\n            } else {\n                product_and_items_count = Utils.translate('1 Product, $(0) Items', item_count);\n            }\n        } else if (item_count === 1) {\n            product_and_items_count = Utils.translate('$(0) Products, 1 Item', product_count);\n        } else {\n            product_and_items_count = Utils.translate(\n                '$(0) Products, $(1) Items',\n                product_count,\n                item_count\n            );\n        }\n\n        // @class Cart.Detailed.View.Context\n        return {\n            // @property {LiveOrder.Model} model\n            model: this.model,\n            // @property {Boolean} showLines\n            showLines: !!(lines && lines.length),\n            // @property {Orderline.Collection} lines\n            lines: lines,\n            // @property {String} productsAndItemsCount\n            productsAndItemsCount: product_and_items_count,\n            // @property {Number} productCount\n            productCount: product_count,\n            // @property {Number} itemCount\n            itemCount: item_count,\n            // @property {String} pageHeader\n            pageHeader: this.page_header\n        };\n        // @class Cart.Detailed.View\n    }\n});\n\nexport = existingView;\n\n"]}